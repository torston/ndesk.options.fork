install:
  - choco install gitversion.portable -pre -y
  - choco install gitlink -y

configuration: Release

build_script:
  - cmd: nuget restore NDesk.Options.Fork\NDesk.Options.Fork.sln
  - cmd: gitversion /l console /output buildserver /updateAssemblyInfo
  
  - cmd: msbuild NDesk.Options.Fork\NDesk.Options.Fork.sln
  
  - cmd: ECHO GitLink NDesk.Options.Fork\ -u https://github.com/torston/NDesk.options.fork -c %CONFIGURATION%
  - cmd: GitLink . -u https://github.com/torston/NDesk.options.fork -c %CONFIGURATION%
  
  - cmd: ECHO nuget pack nuget\NDesk.Options.Fork.nuspec -version "%GitVersion_NuGetVersion%" -prop "configuration=%CONFIGURATION%"
  - cmd: nuget pack nuget\NDesk.Options.Fork.nuspec -version "%GitVersion_NuGetVersion%" -prop "configuration=%CONFIGURATION%"
  - cmd: appveyor PushArtifact "NDesk.Options.Fork.%GitVersion_NuGetVersion%.nupkg"